# Scripts для Personnel Records

Коллекция полезных скриптов для управления системой Personnel Records.

## assign_default_status.py

**Назначение:** Автоматически присваивает статус "В строю" всем сотрудникам, у которых нет ни одного статуса.

**Использование:**

```bash
# Перейдите в корневую директорию проекта
cd Personnel-Records

# Активируйте виртуальное окружение
source ../.venv/bin/activate  # для Linux/Mac
# или
..\.venv\Scripts\activate  # для Windows

# Запустите скрипт
python Scripts/assign_default_status.py
```

**Что делает скрипт:**

1. Находит всех активных сотрудников (employment_status = WORKING)
2. Проверяет, у кого из них нет ни одного статуса
3. Выводит список таких сотрудников
4. Запрашивает подтверждение
5. Создает статус "В строю" для каждого сотрудника:
   - `status_type` = IN_SERVICE
   - `state` = ACTIVE
   - `start_date` = текущая дата
   - `comment` = "Автоматически создан скриптом для сотрудников без статуса"

**Безопасность:**

- Скрипт выполняется в транзакции (при ошибке откатывается)
- Запрашивает подтверждение перед изменениями
- Выводит подробный лог всех операций
- Не модифицирует существующие статусы

**Пример вывода:**

```
================================================================================
Скрипт присвоения статуса 'В строю' сотрудникам без статуса
================================================================================

Найдено активных сотрудников: 150

Сотрудников без статуса: 12

Сотрудники, которым будет присвоен статус 'В строю':
--------------------------------------------------------------------------------
1. Иванов Иван - Департамент IT, Программист
2. Петрова Мария - Отдел кадров, Специалист
...
--------------------------------------------------------------------------------

Продолжить присвоение статусов? (yes/no): yes

Начинаю присвоение статусов...

✓ Создан статус для: Иванов Иван (ID: 101)
✓ Создан статус для: Петрова Мария (ID: 102)
...

================================================================================
РЕЗУЛЬТАТЫ:
================================================================================
Успешно создано статусов: 12
Ошибок: 0

✓ Скрипт завершен!
================================================================================
```

## Требования

- Python 3.12+
- Django 5.2+
- Активное виртуальное окружение проекта
- Доступ к базе данных

## Разработка новых скриптов

При создании новых скриптов следуйте шаблону:

```python
#!/usr/bin/env python
"""
Описание скрипта
"""

import os
import sys
import django

# Настройка Django окружения
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

# Импорты моделей Django
from organization_management.apps.employees.models import Employee

def main():
    """Основная логика скрипта"""
    pass

if __name__ == '__main__':
    try:
        main()
    except KeyboardInterrupt:
        print("\nОперация прервана пользователем.")
        sys.exit(1)
    except Exception as e:
        print(f"\nКритическая ошибка: {e}")
        import traceback
        traceback.print_exc()
        sys.exit(1)
```
